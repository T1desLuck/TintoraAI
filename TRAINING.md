# üéØ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ TintoraAI

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∫–æ–ª–æ—Ä–∏–∑–∞—Ü–∏–∏ TintoraAI, –≤–∫–ª—é—á–∞—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–∞–∏–ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è](#–æ–±–∑–æ—Ä-–ø—Ä–æ—Ü–µ—Å—Å–∞-–æ–±—É—á–µ–Ω–∏—è)
- [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
- [–ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è](#–∑–∞–ø—É—Å–∫-–æ–±—É—á–µ–Ω–∏—è)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
- [–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è](#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏-–æ–±—É—á–µ–Ω–∏—è)
- [–û—Ü–µ–Ω–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏](#–æ—Ü–µ–Ω–∫–∞-–æ–±—É—á–µ–Ω–Ω–æ–π-–º–æ–¥–µ–ª–∏)
- [–°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏](#—Å–æ–≤–µ—Ç—ã-–ø–æ-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
- [–û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö](#–æ–±—É—á–µ–Ω–∏–µ-–Ω–∞-—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö-–Ω–∞–±–æ—Ä–∞—Ö-–¥–∞–Ω–Ω—ã—Ö)
- [–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ](#—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ)
- [–ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è](#–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–µ—à–µ–Ω–∏—è)

## üìä –û–±–∑–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è

–û–±—É—á–µ–Ω–∏–µ TintoraAI –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —Ü–∏–∫–ª–µ:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö** - –°–±–æ—Ä –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä —á–µ—Ä–Ω–æ-–±–µ–ª—ã—Ö –∏ —Ü–≤–µ—Ç–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—É—á–µ–Ω–∏—è
3. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏** - –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö
5. **–¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** - –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
6. **–§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–π –º–æ–¥–µ–ª–∏

## üñºÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –æ–±—É—á–µ–Ω–∏—è TintoraAI —Ç—Ä–µ–±—É—é—Ç—Å—è –ø–∞—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: —á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ (–≤—Ö–æ–¥–Ω—ã–µ) –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º —Ü–≤–µ—Ç–Ω—ã–µ (—Ü–µ–ª–µ–≤—ã–µ). –î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```
data/
‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îú‚îÄ‚îÄ grayscale/  # –ß–µ—Ä–Ω–æ-–±–µ–ª—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ color/      # –¶–≤–µ—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ val/
‚îÇ   ‚îú‚îÄ‚îÄ grayscale/  # –ß–µ—Ä–Ω–æ-–±–µ–ª—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ color/      # –¶–≤–µ—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ test/
‚îÇ   ‚îú‚îÄ‚îÄ grayscale/  # –ß–µ—Ä–Ω–æ-–±–µ–ª—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ color/      # –¶–≤–µ—Ç–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ reference/      # –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —Å—Ç–∏–ª–µ–π
    ‚îú‚îÄ‚îÄ historical/ # –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å—Ç–∏–ª–∏ (1920s, 1950s)
    ‚îú‚îÄ‚îÄ artistic/   # –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏
    ‚îî‚îÄ‚îÄ natural/    # –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–æ–≤—ã–µ –ø–∞–ª–∏—Ç—Ä—ã
```

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –æ–±—É—á–µ–Ω–∏—è TintoraAI –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö:

1. **–û–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö**:
   - [COCO](https://cocodataset.org/)
   - [ImageNet](https://www.image-net.org/)
   - [Places365](http://places2.csail.mit.edu/)

2. **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö**:
   - –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
   - –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
   - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ, —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ –∏ —Ç.–¥.)

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

1. **–°–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**:
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
mkdir -p data/raw data/train/color data/train/grayscale data/val/color data/val/grayscale
```

2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ:
```python
# –ü—Ä–∏–º–µ—Ä —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
import os
import cv2
import numpy as np
from glob import glob
from sklearn.model_selection import train_test_split

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
color_images = glob('data/raw/*.jpg')

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –≤—ã–±–æ—Ä–∫–∏
train_images, val_images = train_test_split(color_images, test_size=0.1, random_state=42)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏
for img_path in train_images:
    # –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–≤–µ—Ç–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    img = cv2.imread(img_path)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–Ω–æ-–±–µ–ª–æ–π –≤–µ—Ä—Å–∏–∏
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–µ–∏—Ö –≤–µ—Ä—Å–∏–π
    filename = os.path.basename(img_path)
    cv2.imwrite(f'data/train/color/{filename}', img)
    cv2.imwrite(f'data/train/grayscale/{filename}', gray)

# –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
# ...
```

3. –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö: –†–∞—Å—à–∏—Ä—å—Ç–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π, —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ `configs/training_config.yaml`.

4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–ü–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
echo "–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Ü–≤–µ—Ç–Ω—ã–µ: $(ls data/train/color | wc -l)"
echo "–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ —á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ: $(ls data/train/grayscale | wc -l)"
echo "–í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–Ω—ã–µ: $(ls data/val/color | wc -l)"
echo "–í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ —á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ: $(ls data/val/grayscale | wc -l)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤
python -c "import os; train_color = set(os.listdir('data/train/color')); train_gray = set(os.listdir('data/train/grayscale')); print(f'–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ: {len(train_color.intersection(train_gray))}'); print(f'–†–∞–∑–ª–∏—á–∏—è: {train_color.symmetric_difference(train_gray)}')"
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `configs/`. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

### –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ (`model_config.yaml`)
```yaml
# –ü—Ä–∏–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏
model:
  img_size: 256  # –†–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Swin-UNet
swin_unet:
  embed_dim: 96
  depths: [2, 2, 6, 2]
  num_heads: [3, 6, 12, 24]

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ViT
vit_semantic:
  embed_dim: 768
  depth: 12
  num_heads: 12

# –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π
guide_net:
  enabled: true
  
discriminator:
  enabled: true
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è (`training_config.yaml`)
```yaml
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è
training:
  batch_size: 16  # –£–º–µ–Ω—å—à–∏—Ç–µ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏
  epochs: 100
  mixed_precision: true  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AMP –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è

# –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä
optimizer:
  type: "adam"
  lr: 0.0002
  beta1: 0.5
  beta2: 0.999
  
# –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
scheduler:
  type: "cosine"
  warmup_epochs: 5
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π –ø–æ—Ç–µ—Ä—å (`loss_config.yaml`)
```yaml
# –í–µ—Å–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø–æ—Ç–µ—Ä–∏
l1_loss:
  enabled: true
  weight: 10.0
  
vgg_perceptual:
  enabled: true
  weight: 1.0
  
gan_loss:
  enabled: true
  weight: 0.1

# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
dynamic_balancer:
  enabled: true
  target_metric: "lpips"
```

## üöÄ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ
–ü–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ:
```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
source venv/bin/activate  # Linux/macOS
# –∏–ª–∏
venv\Scripts\activate     # Windows

# –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è —Å –±–∞–∑–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
python scripts/train.py --config configs/training_config.yaml
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è
```bash
# –û–±—É—á–µ–Ω–∏–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏
python scripts/train.py --config configs/training_config.yaml --model-config configs/model_config.yaml

# –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è —Å —á–µ–∫–ø–æ–∏–Ω—Ç–∞
python scripts/train.py --resume --checkpoint experiments/checkpoints/latest.pth

# –û–±—É—á–µ–Ω–∏–µ –Ω–∞ GPU —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º ID
python scripts/train.py --gpu 0

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
python scripts/train.py --verbose
```

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ Google Colab
```python
# –í Google Colab
!git clone https://github.com/T1desLuck/TintoraAI.git
%cd TintoraAI

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
!pip install -r requirements.txt

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–∏–º–µ—Ä —Å Google Drive)
from google.colab import drive
drive.mount('/content/drive')
!ln -s /content/drive/MyDrive/data data

# –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è
!python scripts/train.py --config configs/training_config.yaml --gpu 0
```

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ Vast.ai
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ Vast.ai
git clone https://github.com/T1desLuck/TintoraAI.git
cd TintoraAI
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ GPU
CUDA_VISIBLE_DEVICES=0,1 python scripts/train.py --distributed --world-size 2
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### TensorBoard
–í–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è TintoraAI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ TensorBoard:
```bash
# –ó–∞–ø—É—Å–∫ TensorBoard
tensorboard --logdir experiments/logs/tensorboard

# –ó–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:6006
```

–ß—Ç–æ –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:
- –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Ç–µ—Ä—å: –æ–±—â–∞—è –ø–æ—Ç–µ—Ä—è –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (L1, VGG, GAN, PatchNCE)
- –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞: PSNR, SSIM, LPIPS
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏: –ø—Ä–∏–º–µ—Ä—ã –∫–æ–ª–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
- –ü—Ä–æ—Ñ–∏–ª–∏: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ñ—É—Ä–Ω–∞–ª—ã –æ–±—É—á–µ–Ω–∏—è
–õ–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `experiments/logs/`:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤ –æ–±—É—á–µ–Ω–∏—è
cat experiments/logs/training.log | tail -50
```

### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏
–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ (—á–µ–∫–ø–æ–∏–Ω—Ç—ã) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `experiments/checkpoints/`:
```bash
# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤
ls -lh experiments/checkpoints/
```

## üß† –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã "–Ω–∞–≥—Ä–∞–¥ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–π"
–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å TintoraAI ‚Äî —Å–∏—Å—Ç–µ–º–∞ "–Ω–∞–≥—Ä–∞–¥ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–π", –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `loss_config.yaml`:
```yaml
reward_system:
  enabled: true
  guide_net:  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è GuideNet
    reward_weight: 1.0
    penalty_weight: 1.5
  discriminator:  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Discriminator
    reward_weight: 1.0
    penalty_weight: 1.2
```

### Few-shot –∞–¥–∞–ø—Ç–∞—Ü–∏—è
–î–ª—è –æ–±—É—á–µ–Ω–∏—è —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
# –ó–∞–ø—É—Å–∫ few-shot –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
python scripts/train.py --config configs/training_config.yaml --shot-number 5 --adaptation-steps 10
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ:
```yaml
adaptable:
  enabled: true
  adapter_type: "standard"
  bottleneck_dim: 64
  shot_number: 5
```

### –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç–∏–ª—è –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
–î–ª—è –æ–±—É—á–µ–Ω–∏—è —Å –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç–∏–ª—è:
```bash
python scripts/train.py --config configs/training_config.yaml --style-transfer
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–∏–ª–µ–π:
```yaml
style_transfer:
  enabled: true
  content_weight: 1.0
  style_weight: 100.0
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Memory Bank
Memory Bank –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—å—Å—è –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö:
```yaml
memory_bank:
  enabled: true
  feature_dim: 256
  max_items: 1000
  use_fusion: true
```

## üéØ –û—Ü–µ–Ω–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –≤–∞–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏:
```bash
# –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö
python scripts/evaluate.py --checkpoint experiments/checkpoints/best_model.pth --test-dir data/test

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ—Ü–µ–Ω–∫–∏
python scripts/evaluate.py --checkpoint experiments/checkpoints/best_model.pth --test-dir data/test --save-comparison --plot-metrics
```

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
TintoraAI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–ª–æ—Ä–∏–∑–∞—Ü–∏–∏:
- PSNR (Peak Signal-to-Noise Ratio) - —á–µ–º –≤—ã—à–µ, —Ç–µ–º –ª—É—á—à–µ
- SSIM (Structural Similarity Index) - —Ü–µ–ª—å ‚â• 0.82
- LPIPS (Learned Perceptual Image Patch Similarity) - —Ü–µ–ª—å ‚â§ 0.20
- FID (Fr√©chet Inception Distance) - —á–µ–º –Ω–∏–∂–µ, —Ç–µ–º –ª—É—á—à–µ

### –ê–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
–î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
```bash
python scripts/evaluate.py --checkpoint experiments/checkpoints/best_model.pth --test-dir data/test --categories data/test/categories.json
```

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–º–µ—à–∞–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ (AMP):
```yaml
training:
  mixed_precision: true
```
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
```yaml
data:
  num_workers: 8
  prefetch_factor: 2
  pin_memory: true
```
- Gradient checkpointing –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏:
```yaml
swin_unet:
  use_checkpoint: true
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ—Ç–µ—Ä—å:
```yaml
dynamic_balancer:
  enabled: true
  learning_rate: 0.01
```
- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
```yaml
scheduler:
  type: "cosine"
  warmup_epochs: 5
```
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏:
```yaml
augmentations:
  horizontal_flip: true
  rotate: true
  brightness: 0.1
  contrast: 0.1
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–º–µ—Ä—É –±–∞—Ç—á–∞
| GPU VRAM | –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ |
|----------|--------------------|---------------------------|
| 6 GB     | 256x256           | 8-16                     |
| 8 GB     | 256x256           | 16-24                    |
| 11+ GB   | 256x256           | 24-32                    |
| 8 GB     | 512x512           | 4-8                      |
| 16+ GB   | 512x512           | 8-16                     |

## üîç –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
–î–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö:
1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```yaml
# –í training_config.yaml
data:
  reference_dataset_path: "data/reference/historical"
  
# –í model_config.yaml
memory_bank:
  enabled: true
  feature_dim: 256
```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```bash
python scripts/train.py --config configs/training_config.yaml --batch-size 8 --style historical
```

### –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
–î–ª—è –∫–æ–ª–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π:
1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–∞
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
```yaml
# –í training_config.yaml
data:
  reference_dataset_path: "data/reference/artistic"
  
# –í model_config.yaml
style_transfer:
  enabled: true
  content_weight: 1.0
  style_weight: 150.0  # –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –≤–µ—Å –¥–ª—è —Å—Ç–∏–ª—è
```

## üåê –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
### –ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
–î–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö GPU:
```bash
# –° —É–∫–∞–∑–∞–Ω–∏–µ–º GPU-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
python scripts/train.py --distributed --device-ids 0,1,2,3

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
python scripts/train.py --distributed --world-size 4
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
```yaml
# –í training_config.yaml
training:
  distributed: true
  sync_bn: true
```

## üîß –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –†–µ–∂–∏–º –∫–æ–ª–ª–∞–ø—Å–∞ (Mode Collapse)
**–°–∏–º–ø—Ç–æ–º—ã**: –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, —á–∞—Å—Ç–æ –¥–µ—Å–∞—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–º–µ–Ω—å—à–∏—Ç–µ –≤–µ—Å GAN-–ø–æ—Ç–µ—Ä–∏:
```yaml
gan_loss:
  weight: 0.05  # –£–º–µ–Ω—å—à–∏—Ç–µ —Å 0.1
```
2. –£–≤–µ–ª–∏—á—å—Ç–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ spectrum normalization –≤ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–µ:
```yaml
discriminator:
  use_spectral_norm: true
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
**–°–∏–º–ø—Ç–æ–º—ã**: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –ø–æ—Ç–µ—Ä—å, —Ä–∞—Å—Ö–æ–¥—è—â–µ–µ—Å—è –æ–±—É—á–µ–Ω–∏–µ.

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–º–µ–Ω—å—à–∏—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è:
```yaml
optimizer:
  lr: 0.0001  # –£–º–µ–Ω—å—à–∏—Ç–µ —Å 0.0002
```
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–µ –æ—Ç—Å–µ—á–µ–Ω–∏–µ:
```yaml
training:
  max_grad_norm: 1.0
```
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫:
```yaml
scheduler:
  type: "step"
  step_size: 30
  gamma: 0.5
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –ø–∞–º—è—Ç–∏ GPU
**–°–∏–º–ø—Ç–æ–º—ã**: `CUDA out of memory` –æ—à–∏–±–∫–∏.

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞:
```yaml
training:
  batch_size: 8  # –£–º–µ–Ω—å—à–∏—Ç–µ —Å 16
```
2. –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
```yaml
model:
  img_size: 224  # –£–º–µ–Ω—å—à–∏—Ç–µ —Å 256
```
3. –í–∫–ª—é—á–∏—Ç–µ gradient checkpointing:
```yaml
swin_unet:
  use_checkpoint: true
```
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–º–µ—à–∞–Ω–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å:
```bash
python scripts/train.py --mixed-precision
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ü–≤–µ—Ç–æ–≤
**–°–∏–º–ø—Ç–æ–º—ã**: –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –±–ª–µ–¥–Ω—ã–µ, –¥–µ—Å–∞—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–≤–µ–ª–∏—á—å—Ç–µ –≤–µ—Å VGG perceptual loss:
```yaml
vgg_perceptual:
  weight: 1.5  # –£–≤–µ–ª–∏—á—å—Ç–µ —Å 1.0
```
2. –£–≤–µ–ª–∏—á—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç–∏:
```yaml
postprocessing:
  saturation: 1.2  # –£–≤–µ–ª–∏—á—å—Ç–µ —Å 1.0
```
3. –£—Å–∏–ª—å—Ç–µ PatchNCE loss –¥–ª—è –±–æ–ª–µ–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è:
```yaml
patch_nce:
  weight: 1.5
```

–î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ Issues –Ω–∞ GitHub –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Issue —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤–∞—à–µ–π –ø—Ä–æ–±–ª–µ–º—ã.